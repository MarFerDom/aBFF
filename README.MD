%### ABOUT FEATURES ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###
%#
%## FEATURES EXTRACTION ### ### ### ### ### ###
%# NB-15 extracts features from Argus and Zeek programs. featuresNB15.py joins with label file provided
%# by the pcap source and calculates 12 extra features as described in (Moustafa et al 2015).
%#
%# CICFlowMeter extracts CIC features. featuresCIC.py joins with label file provided by the pcap source
%# and adds Flow ID.
%## SOURCE PCAP ### ### ### ### ### ### ### ###
%#
%# AB-TRAP (bonafide) is extracted from MAWILab by filering with labeled file provided by the pcap source.
%# bonafide is split for processing in Argus/Zeek. Files must be joined before calculating group features.
%# attack is generated by simulation and each ip represents an attack category.
%# attack and bonafide datasets must be joined at the end.
%# attacks and traffic occur separatedly in time.
%#
%# UNSW-NB15 label file NUSW-NB15_GT.csv is provided by the pcap source.
%#
%# CIC-IDS2017 label files in GeneratedLabelledFlows.zip are provided by the pcap source.
%### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###%%%


%### MAIN FILES ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###
%#
%# 0_get_CIC_from_labels.py
%# 1_Extract_Features.sh
%# 2_
%# 
%### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###

%### 0_get_CIC_from_labels.py ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###
%#
%# Use CIC label files as "CIC"_CIC.csv in case 
%### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###



%### 1_Extract_Features.sh [inputDirectory] ### ### ### ### ### ### ### ### ### ### ### ### ###
%#
%# Generates files for later extraction of dataset features
%# Requires: Argus, Zeek, cicflowmeter.py

%# Argus: [sudo apt-get install argus-server] OR http://qosient.com/argus/src/argus-3.0.8.2.tar.gz
%# Zeek: https://download.zeek.org/zeek-4.1.1.tar.gz
%# CICFlowMeter: [sudo python3 -m pip install cicflowmeter] OR
%# [git clone https://github.com/CanadianInstituteForCybersecurity/CICFlowMeter.git]
%#
%# Creates inner directory per pcap file and runs Argus, Zeek and CICFlowMeter on all
%# PCAP files in current directory.
%#
%## NOTE_1: For running MAWILab and CIC-IDS through CICFlowMeter it was necessary to force
%# linktype to 1 [EN10MB(Ethernet)] in utils.py as: https://www.tcpdump.org/linktypes.html
%#
%## NOTE_2: Remember to edit /home/YOUR_USER/.local/lib/python3.9/site-packages/scapy/utils.py ##
%# %------------------------------------------------------------------------------------------%
%# %
%# %+
%# % import numpy
%# %
%# %-
%# % def __truediv__(self, other):
%# %        # type: (_Decimal) -> EDecimal
%# %        return EDecimal(Decimal.__truediv__(self, Decimal(other)))
%# %
%# %+
%# % def __truediv__(self, other):
%# %        # type: (_Decimal) -> EDecimal
%# %        return EDecimal(Decimal.__truediv__(self, Decimal(numpy.float64(other))))
%# %
%# % GET ALT -> if(): else: linktype = 1
%# %------------------------------------------------------------------------------------------%
%### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###



%### 2_Build_dataset.ipynb ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###
%#
%# Build NB15 and CIC type datasets for each pcap
%#
%# Requires: featuresNB15.py featuresCIC.py
%### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###



%### 3_train_model.ipynb ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###
%#
%# Train ML models for each dataset
%#
%# Requires: train_model.py
%### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###
